{
  "annotations": { "list": [] },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 1,
  "id": null,
  "iteration": 1,
  "links": [],
  "panels": [
    {
      "type": "stat",
      "title": "Total Active Users",
      "gridPos": { "h": 4, "w": 6, "x": 0, "y": 0 },
      "targets": [
        {
          "expr": "count(count by (user_id) (reporunner_user_activity_total))",
          "legendFormat": "Active Users",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          }
        }
      }
    },
    {
      "type": "stat",
      "title": "Total Workflows",
      "gridPos": { "h": 4, "w": 6, "x": 6, "y": 0 },
      "targets": [
        {
          "expr": "reporunner_workflows_total",
          "legendFormat": "Workflows",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          }
        }
      }
    },
    {
      "type": "stat",
      "title": "Total Executions (24h)",
      "gridPos": { "h": 4, "w": 6, "x": 12, "y": 0 },
      "targets": [
        {
          "expr": "sum(increase(reporunner_workflow_executions_total[24h]))",
          "legendFormat": "Executions",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          }
        }
      }
    },
    {
      "type": "stat",
      "title": "Success Rate (24h)",
      "gridPos": { "h": 4, "w": 6, "x": 18, "y": 0 },
      "targets": [
        {
          "expr": "sum(increase(reporunner_workflow_executions_total{status=\"success\"}[24h])) / sum(increase(reporunner_workflow_executions_total[24h])) * 100",
          "legendFormat": "Success %",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "yellow", "value": 90 },
              { "color": "green", "value": 95 }
            ]
          }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "Daily Active Users",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 4 },
      "targets": [
        {
          "expr": "count(count by (user_id) (increase(reporunner_user_activity_total[24h]) > 0))",
          "legendFormat": "DAU",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "Workflow Executions per Hour",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 4 },
      "targets": [
        {
          "expr": "sum(rate(reporunner_workflow_executions_total[1h]))",
          "legendFormat": "Executions/hr",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "Execution Status Distribution",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 12 },
      "targets": [
        {
          "expr": "sum(rate(reporunner_workflow_executions_total[5m])) by (status)",
          "legendFormat": "{{status}}",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "ops",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "piechart",
      "title": "Workflows by Integration",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 12 },
      "targets": [
        {
          "expr": "sum(reporunner_workflows_by_integration) by (integration)",
          "legendFormat": "{{integration}}",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      }
    },
    {
      "type": "timeseries",
      "title": "New User Signups",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 20 },
      "targets": [
        {
          "expr": "increase(reporunner_users_total[1d])",
          "legendFormat": "New Users/day",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "Workflow Creation Rate",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 20 },
      "targets": [
        {
          "expr": "increase(reporunner_workflows_created_total[1h])",
          "legendFormat": "New Workflows/hr",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "Average Workflow Execution Time",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 28 },
      "targets": [
        {
          "expr": "sum(rate(reporunner_workflow_execution_duration_seconds_sum[5m])) / sum(rate(reporunner_workflow_execution_duration_seconds_count[5m]))",
          "legendFormat": "Avg Duration",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "s",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "timeseries",
      "title": "Integration Usage",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 28 },
      "targets": [
        {
          "expr": "sum(rate(reporunner_integration_usage_total[5m])) by (integration)",
          "legendFormat": "{{integration}}",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "ops",
          "color": { "mode": "palette-classic" }
        }
      }
    },
    {
      "type": "table",
      "title": "Top 10 Active Workflows",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 36 },
      "targets": [
        {
          "expr": "topk(10, sum(increase(reporunner_workflow_executions_total[24h])) by (workflow_id, workflow_name))",
          "legendFormat": "{{workflow_name}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": { "Time": true, "__name__": true, "workflow_id": true },
            "indexByName": { "workflow_name": 0, "Value": 1 },
            "renameByName": { "workflow_name": "Workflow Name", "Value": "Executions (24h)" }
          }
        }
      ]
    },
    {
      "type": "table",
      "title": "User Engagement Metrics",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 36 },
      "targets": [
        {
          "expr": "topk(10, sum(increase(reporunner_user_activity_total[24h])) by (user_id))",
          "legendFormat": "{{user_id}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": { "Time": true, "__name__": true },
            "indexByName": { "user_id": 0, "Value": 1 },
            "renameByName": { "user_id": "User ID", "Value": "Activity Score" }
          }
        }
      ]
    },
    {
      "type": "stat",
      "title": "Credential Count",
      "gridPos": { "h": 4, "w": 6, "x": 0, "y": 44 },
      "targets": [
        {
          "expr": "reporunner_credentials_total",
          "legendFormat": "Credentials",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          }
        }
      }
    },
    {
      "type": "stat",
      "title": "Active Integrations",
      "gridPos": { "h": 4, "w": 6, "x": 6, "y": 44 },
      "targets": [
        {
          "expr": "count(count by (integration) (reporunner_integration_usage_total > 0))",
          "legendFormat": "Active",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          }
        }
      }
    },
    {
      "type": "stat",
      "title": "Avg Nodes per Workflow",
      "gridPos": { "h": 4, "w": 6, "x": 12, "y": 44 },
      "targets": [
        {
          "expr": "avg(reporunner_workflow_nodes_count)",
          "legendFormat": "Avg Nodes",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "decimals": 1,
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          }
        }
      }
    },
    {
      "type": "stat",
      "title": "Total Organizations",
      "gridPos": { "h": 4, "w": 6, "x": 18, "y": 44 },
      "targets": [
        {
          "expr": "reporunner_organizations_total",
          "legendFormat": "Organizations",
          "refId": "A"
        }
      ],
      "datasource": { "type": "prometheus", "uid": "PROM_DS" },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "thresholds": {
            "mode": "absolute",
            "steps": [{ "color": "green", "value": null }]
          }
        }
      }
    }
  ],
  "refresh": "1m",
  "schemaVersion": 37,
  "style": "dark",
  "tags": ["reporunner", "business", "metrics", "analytics"],
  "templating": { "list": [] },
  "time": { "from": "now-7d", "to": "now" },
  "timezone": "",
  "title": "Reporunner Business Metrics",
  "uid": "reporunner-business-metrics",
  "version": 1
}
